package filius.software.exploit;

import filius.software.Anwendung;
import filius.software.SMB.SMBClient;
import filius.software.system.InternetKnotenBetriebssystem;

import java.security.PublicKey;

public class Exploit extends Anwendung {

    private final SMBClient smbClient;

    public Exploit(InternetKnotenBetriebssystem internetKnotenBetriebssystem) {
        super();
        System.out.println("Neue Instanz vom Exploit wurde kreiert");
        this.setSystemSoftware(internetKnotenBetriebssystem);
        smbClient = new SMBClient(this.getSystemSoftware());
        System.out.println("Neue SMBClient wurde instanziiert");
        smbClient.starten();
        System.out.println("SMBClient wurde gestartet");
    }

    /**
     * try to infect the system with the given ipAdress
     * @param ipAdress The IP of the Victim
     * @param publicKey
     */
	public void infect(String ipAdress, PublicKey publicKey) {
	    smbClient.sendMessage(ipAdress, publicKey);
    }
}
